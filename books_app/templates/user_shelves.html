{% extends "base.html" %}
{% block content %}


    <h3 class="center-align">{% if user.id == request.session.user_id %}Your{% else %}{{user.first_name}}'s{% endif %} Shelves</h3>

    {% if messages %}
        {% for message in messages %}
            <p{% if message.tags %} class="{{message.tags}}"{% endif %}>
                {{message}}
            </p>
        {% endfor %}
    {% endif %}

    <table class="highlight">
        <thead>
            <th>Name</th>
            <th>Last Book</th>
            <th>Date</th>
            <th>Actions</th>
        </thead>
        <tbody>
            <tr>
                {% for shelf in user.shelves.all %}
                <td>
                    {% if editing and edit_shelf_id == shelf.id %}
                    <form method="POST" action="/shelves/{{shelf.id}}/update">
                    {% csrf_token %}
                        <input type="text" value="{{shelf.name}}" name="name">
                        <input hidden type="submit">
                    </form>

                    {% else %}
                    <a href="/shelves/{{shelf.id}}">{{ shelf.name }}</a>
                    {% endif %}
                </td>
                <td>{{ shelf.books.last.title }}</td>
                <td>{{ shelf.created_at }}</td>
                <td>
                {% if not shelf.fixed %}
                    {% if editing and edit_shelf_id == shelf.id %}
                    <a href="/users/{{request.session.user_id}}/shelves">Cancel</a>

                    {% else %}
                    <a href="/shelves/{{shelf.id}}/edit">Edit</a>
                    {% endif %}
                    
                    | <a href="/shelves/{{shelf.id}}/delete">Delete</a>
                {% endif %}

                </td>
            </tr>
        </body>
        {% endfor %}        
    </table>

    {% if not editing %}
    <section>
        <form action="/shelf/create" method="POST">
            {% csrf_token %}
            <div class="input-field">
                <input  type="text" placeholder="Add New Shelf Here..." name="name">
                <button class="btn waves-effect waves-light" type="submit" name="action">Submit<i class="material-icons right">send</i></button>
                {% comment %} <input type="submit" class="btn"></p> {% endcomment %}
            </div>
        </form>
    </section>
    {% endif %}

{% endblock %}